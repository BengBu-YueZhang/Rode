{"version":3,"sources":["../node_modules/@material-ui/icons/Image.js","components/LoadMore.js","views/List.js"],"names":["_interopRequireDefault","__webpack_require__","Object","defineProperty","exports","value","default","_react","_default","createElement","Fragment","fill","d","LoadMore","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","hanldeAddEvent","ref","current","addEventListener","handleLoadMore","handleDeleteEvent","removeEventListener","loadedAll","loading","offsetHeight","scrollTop","childrenRef","load","React","createRef","_this$props","classes","react_default","a","className","root","children","CircularProgress_default","size","Component","defaultProps","compose","withStyles","position","width","height","overflowX","overflowY","display","justifyContent","alignItems","PostList","loadMore","setState","prevState","filter","page","get","more","dispatch","_this$state$filter","state","limit","actions","postRequest","posts","components_LoadMore","List_default","list","map","li","key","id","ListItem_default","component","href","concat","button","author","avatar_url","Avatar_default","src","Image_default","ListItemText_default","primary","text","title","secondary","Date","create_at","toDateString","Divider_default","connect","getPosts","getLoading","getLoadedAll","backgroundColor","whiteSpace","overflow","textOverflow"],"mappings":"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","file":"static/js/4.8f8d8f4d.chunk.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(_react.default.Fragment, null, _react.default.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0z\"\n}), _react.default.createElement(\"path\", {\n  d: \"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\"\n})), 'Image');\n\nexports.default = _default;","import React from 'react'\nimport { withStyles } from '@material-ui/core/styles'\nimport { compose } from 'redux'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport PropTypes from 'prop-types'\n\nconst styles = {\n  root: {\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'auto'\n  },\n  loading: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: '100%',\n    height: '60px'\n  }\n}\n\nclass LoadMore extends React.Component {\n  constructor (props) {\n    super(props)\n    this.ref = React.createRef()\n  }\n\n  componentDidMount () {\n    this.hanldeAddEvent()\n  }\n\n  componentWillUnmount () {\n    this.handleDeleteEvent()\n  }\n\n  hanldeAddEvent = () => {\n    this.ref.current.addEventListener('scroll', this.handleLoadMore)\n  }\n\n  handleDeleteEvent = () => {\n    this.ref.current.removeEventListener('scroll', this.handleLoadMore)\n  }\n\n  handleLoadMore = () => {\n    if (this.props.loadedAll || this.props.loading) return\n    const height = this.ref.current.offsetHeight\n    const scrollTop = this.ref.current.scrollTop\n    if (height + scrollTop === this.props.childrenRef.current.offsetHeight) {\n      this.props.load()\n    }\n  }\n\n  render () {\n    const { classes, loading } = this.props\n    return (\n      <div ref={this.ref} className={classes.root}>\n        {\n          this.props.children\n        }\n        {\n          loading && (\n            <div className={classes.loading}>\n              <CircularProgress size={24}/>\n            </div>\n          )\n        }\n      </div>\n    )\n  }\n}\n\nLoadMore.propTypes = {\n  loadedAll: PropTypes.bool,\n  loading: PropTypes.bool,\n  load: PropTypes.func,\n  childrenRef: PropTypes.shape({\n    current: PropTypes.object\n  }).isRequired,\n  children: PropTypes.element.isRequired\n}\n\nLoadMore.defaultProps = {\n  loadedAll: false,\n  loading: false,\n  load: () => {}\n}\n\nexport default compose(withStyles(styles))(LoadMore)\n","import React from 'react'\n// import PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport Avatar from '@material-ui/core/Avatar'\nimport { compose } from 'redux'\nimport { connect } from 'react-redux'\nimport { getPosts, getLoading, getLoadedAll } from '@/store/selectors/posts'\nimport actions from '@/store/actions'\nimport ImageIcon from '@material-ui/icons/Image'\nimport Divider from '@material-ui/core/Divider'\nimport LoadMore from '@/components/LoadMore'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nconst styles = {\n  list: {\n    backgroundColor: '#fff'\n  },\n  text: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    posts: getPosts(state),\n    loading: getLoading(state),\n    loadedAll: getLoadedAll(state)\n  }\n}\n\nclass PostList extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      filter: {\n        page: 1,\n        limit: 20\n      }\n    }\n    this.ref = React.createRef()\n  }\n\n  componentDidMount () {\n    this.get(false)\n  }\n\n  loadMore = () => {\n    this.setState(prevState => {\n      return {\n        filter: {\n          page: prevState.filter.page + 1\n        }\n      }\n    }, () => {\n      this.get(true)\n    })\n  }\n\n  get = (more) => {\n    const { dispatch } = this.props\n    const { page, limit } = this.state.filter\n    dispatch(actions.postRequest(page, limit, more))\n  }\n\n  render () {\n    // 如果你不在 render() 中使用某些东西，它就不应该在状态中\n    const { classes, posts, loadedAll, loading } = this.props\n    return (\n      <LoadMore\n        childrenRef={this.ref}\n        load={this.loadMore}\n        loadedAll={loadedAll}\n        loading={loading}\n      >\n        <div ref={this.ref}>\n          <List className={classes.list} >\n            {\n              posts.size > 0 && posts.map(li => {\n                return (\n                  <React.Fragment key={li.id}>\n                    <ListItem component=\"a\" href={`#detail?${li.id}`} button>\n                      {\n                        li.author && li.author.avatar_url ? (\n                          <Avatar src={li.author.avatar_url}/>\n                        ) : ( <ImageIcon/> )\n                      }\n                      <ListItemText\n                        primary={<p className={classes.text}>{li.title}</p>}\n                        secondary={<span>{new Date(li.create_at).toDateString()}</span>}\n                      />\n                    </ListItem>\n                    <Divider/>\n                  </React.Fragment>\n                )\n              })\n            }\n          </List>\n        </div>\n      </LoadMore>\n    )\n  }\n}\n\nexport default compose(connect(mapStateToProps), withStyles(styles))(PostList)\n"],"sourceRoot":""}